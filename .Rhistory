View(Obsidian)
View(Obsidian)
o2 <- ta_add_totals(Obsidian)
o2
View(o2)
View(o2)
ta_chi_square_cell_values()
ta_chi_square_cell_values(Obsidian)
ta_chisq_p(Obsidian)
ta_Cramers_V(Obsidian)
Woodard <- Obsidian[,1:2]
ta_Cramers_V(Woodard)
View(Woodard)
View(Woodard)
ta_chi_square(Woodard)
Table <- Woodard
rows <- nrow(Table)
cols <- ncol(Table)
Table <- ta_chi_square_cell_values(Table)
Table <- Woodard
rows <- nrow(Table)
cols <- ncol(Table)
expected <- ta_expected(Table)
rows <- nrow(Table)
cols <- ncol(Table)
totals <- ta_add_totals(Table)
rows <- nrow(Table)
cols <- ncol(Table)
row_total <- vector(mode = "numeric", rows)
column_total <- vector(mode = "numeric", cols + 1)
column_total <- vector(mode = "numeric", cols + 1)
rows <- nrow(Table)
cols <- ncol(Table)
row_total <- vector(mode = "numeric", rows)
column_total <- vector(mode = "numeric", cols + 1)
for (i in 1:rows) {
row_total[i] <- sum(Table[i,1:cols])
}
for (i in 1:cols){
column_total[i] <- sum(Table[1:rows, i])
}
column_total[rows+1] <- sum(column_total)
Table <- cbind(Table,row_total)
View(Table)
cols <- ncol(Table)
for (i in 1:cols){
column_total[i] <- sum(Table[1:rows, i])
}
View(Woodard)
rows <- nrow(Table)
cols <- ncol(Table)
View(Table)
View(Table)
table <- Woodard
Table <- Woodard
rows <- nrow(Table)
cols <- ncol(Table)
row_total <- vector(mode = "numeric", rows)
column_total <- vector(mode = "numeric", cols + 1)
for (i in 1:rows) {
row_total[i] <- sum(Table[i,1:cols])
}
for (i in 1:cols){
column_total[i] <- sum(Table[1:rows, i])
}
column_total[cols+1] <- sum(column_total)
Table <- cbind(Table,row_total)
return(rbind(Table,column_total))
ta_add_totals(Woodard)
ta_add_totals(Obsidian)
ta_add_totals(Obsidian)
ta_add_totals(Woodard)
Table <- Woodard
rows <- nrow(Table)
cols <- ncol(Table)
row_total <- vector(mode = "numeric", rows)
column_total <- vector(mode = "numeric", cols + 1)
for (i in 1:rows) {
row_total[i] <- sum(Table[i,1:cols])
}
for (i in 1:cols){
column_total[i] <- sum(Table[1:rows, i])
}
View(Table)
View(Table)
column_total[rows+1] <- sum(column_total)
column_total <- vector(mode = "numeric", cols + 1)
for (i in 1:rows) {
row_total[i] <- sum(Table[i,1:cols])
}
for (i in 1:cols){
column_total[i] <- sum(Table[1:rows, i])
}
column_total[cols+1] <- sum(column_total)
View(Table)
View(Table)
Table <- cbind(Table,row_total)
rbind(Table,column_total)
library(TableAnalysis)
library(TableAnalysis)
ta_chi_square(Obsidian)
Obsidian
data(Obsidian)
o2 <- ta_add_totals(Obsidian)
ta_chi_square_cell_values(Obsidian)
ta_chisq_p(Obsidian)
ta_Cramers_V(Obsidian)
Woodard <- Obsidian[,1:2]
ta_Cramers_V(Woodard)
ta_chi_square(Woodard)
WolfVillage <- Obsidian[,3:4]
ta_Cramers_V(WolfVillage)
ta_chi_square(WolfVillage)
ta_add_totals(WolfVillage)
ta_add_totals(Woodard)
ta_cell_values(Woodard)
ta_chisq_cell_values(Woodard)
ta_chi_square_cell_values(Woodard)
ta_expected(WolfVillage)
Table <- Obsidian
N <- ta_add_totals(Table)[rows+1, cols+1]
rows <- nrow(Table1)
cols <- ncol(Table1)
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
o2 <- ta_add_totals(Obsidian)
o2
proportions <- Table/N]
proportions <- Table/N
View(proportions)
ta_add_totals(proportions)
str(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
iterations <- 10
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
prob <- stack(proportions1)
prob <- stack(proportions)
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
View(prob)
View(prob)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- as.matrix((SimTable))
chitest <- chisq.test(SimTable)
chisqsim <- as.numeric(chitest$statistic)
CramersVBoot1[i] <- sqrt(chisqsim/(marginalTotals1[rows+1,cols+1]*min(rows-1,cols-1)))
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot1[i] <- sqrt(chisqsim/N*min(rows-1,cols-1)))
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot1[i] <- sqrt(chisqsim/N*min(rows-1,cols-1)))
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot1[i] <- sqrt(chisqsim/N*min(rows-1,cols-1)))
}
Table <- Obsidian
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
iterations <- 20
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot1[i] <- sqrt(chisqsim/N*min(rows-1,cols-1)))
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot1[i] <- sqrt(chisqsim/N*min(rows-1,cols-1)))
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot1[i] <- sqrt(chisqsim/(N*min(rows-1,cols-1)))
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot1[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
}
hist(Cramers_V_Boot)
ta_Cramers_V(Table)
Woodard <- Obsidian[,1:2]
WolfVillage <- Obsidian[,3:4]
Table <- Woodard
ta_Cramers_V_bootstrap <- function(Table, iterations) {
ta_Cramers_V_bootstrap <- function(Table, iterations) {
ta_Cramers_V_bootstrap <- function(Table, iterations) {
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
}
}
ta_Cramers_V_bootstrap(Obsidian, 100)
ta_Cramers_V_bootstrap <- function(Table, iterations) {
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
return(Cramers_V_Boot)
}
}
ta_Cramers_V_bootstrap(Obsidian, 100)
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
Table <- Obsidian
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
iterations <- 100
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
return(Cramers_V_Boot)
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
return(Cramers_V_Boot)
}
iterations <- 10
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
SimTable <- (SimTable)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
return(Cramers_V_Boot)
}
??rmultinom
??rmultinom()
View(SimTable)
View(SimTable)
View(SimTable)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
return(Cramers_V_Boot)
}
ta_Cramers_V_bootstrap <- function(Table, iterations) {
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
chi_square <- ta_chi_square(SimTable)
Cramers_V_Boot[i] <- sqrt(chi_square/(N*min(rows-1,cols-1)))
return(Cramers_V_Boot)
}
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
return(Cramers_V_Boot)
}
ta_Cramers_V_bootstrap <- function(Table, iterations) {
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
return(Cramers_V_Boot)
}
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
return(Cramers_V_Boot)
}
ta_Cramers_V_bootstrap <- function(Table, iterations) {
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
return(Cramers_V_Boot)
}
}
for (i in 1:10) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
return(Cramers_V_Boot)
}
for (i in 1:10) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
return(Cramers_V_Boot)
}
for (i in 1:10) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
}
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
}
return(Cramers_V_Boot)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
}
return(Cramers_V_Boot)
Woodard <- Obsidian[,1:2]
WolfVillage <- Obsidian[,3:4]
ta_Cramers_V_bootstrap(Woodard, 1000)
ta_Cramers_V_bootstrap <- function(Table, iterations) {
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
}
return(Cramers_V_Boot)
}
ta_Cramers_V_bootstrap(Woodard, 1000)
Woodard <- ta_Cramers_V_bootstrap(Woodard, 1000)
Woodard <- Obsidian[,1:2]
ta_Cramers_V_bootstrap <- function(Table, iterations) {
rows <- nrow(Table)
cols <- ncol(Table)
N <- ta_add_totals(Table)[rows+1, cols+1]
proportions <- as.data.frame(Table/N)
prob <- stack(proportions)
Cramers_V_Boot <- vector(mode = "numeric", length = iterations)
for (i in 1:iterations) {
Sim1 <- rmultinom(1,N,prob=prob$values)
SimTable <- as.data.frame(cbind(Sim1,prob$ind))
SimTable <- unstack(SimTable, form = V1 ~ V2)
Cramers_V_Boot[i] <- ta_Cramers_V(SimTable)
}
return(as.data.frame(Cramers_V_Boot))
}
WoodardCV <- ta_Cramers_V_bootstrap(Woodard, 1000)
hist(WoodardCV)
ggplot(WoodardCV)
library(tidyverse)
View(WoodardCV)
View(WoodardCV)
ggplot(WoodardCV) +
geom_histogram(aes(x = Cramers_V_Boot))
ggplot(WoodardCV) +
geom_histogram(aes(x = Cramers_V_Boot), color = "black, fill = "lightblue")
ggplot(WoodardCV) +
geom_histogram(aes(x = Cramers_V_Boot), color = "black, fill = "lightblue")
ggplot(WoodardCV) +
geom_histogram(aes(x = Cramers_V_Boot), color = "black", fill = "lightblue")
ggplot(WoodardCV) +
geom_boxplot(aes(x = Cramers_V_Boot), color = "black", fill = "lightblue")
WolfVillageCV <- ta_Cramers_V_bootstrap(WolfVillage)
WolfVillageCV <- ta_Cramers_V_bootstrap(WolfVillage, 1000)
ggplot(WoodardCV) +
geom_histogram(aes(x = Cramers_V_Boot), color = "black", fill = "lightblue") +
geom_histogram(aes(x = Cramers_V_Boot), color = "black", fill = "lightblue") +
theme_bw()
ggplot() +
geom_boxplot(WoodardCV, aes(x = Cramers_V_Boot), color = "black", fill = "lightblue") +
geom_boxplot(WolfVillageCV, aes(x = Cramers_V_Boot), color = "black", fill = "lightblue") +
theme_bw()
ggplot() +
geom_boxplot(WoodardCV, aes(x = Cramers_V_Boot), color = "black", fill = "lightblue") +
theme_bw()
ggplot(WoodardCV) +
geom_boxplot(aes(x = Cramers_V_Boot), color = "black", fill = "lightblue") +
theme_bw()
library(TableAnalysis)
ta_Cramers_V_bootstrap(Obsidian, 1000)
library(TableAnalysis)
ta_Cramers_V_bootstrap(Obsidian, 1000)
ta_resample_Cramers_V(Obsidian, 1000)
library(TableAnalysis)
ta_Cramers_V_bootstrap(Obsidian, 1000)
library(TableAnalysis)
library(TableAnalysis)
ta_resample_Cramers_V(Obsidian, 10000)
library(tidyverse)
CV <- ta_resample_Cramers_V(Obsidian, 1000)
ggplot(CV) +
View(CV)
geom_histogram(aes(x = Cramers_V_resampling), fill = "lightblue)
ggplot(CV) +
geom_histogram(aes(x = Cramers_V_resampling))
ggplot(CV) +
geom_histogram(aes(x = Cramers_V_resampling), fill = "lightblue")
ggplot(CV) +
geom_histogram(aes(x = Cramers_V_resampling), color = "black", fill = "lightblue")
ggplot(CV) +
geom_histogram(aes(x = Cramers_V_resampling), color = "black", fill = "lightblue") +
theme_bw()
ggplot(CV) +
geom_histogram(aes(x = Cramers_V_resampling), binwidth = .01, color = "black", fill = "lightblue") +
theme_bw()
ggplot(CV) +
geom_histogram(aes(x = Cramers_V_resampling), binwidth = .001, color = "black", fill = "lightblue") +
theme_bw()
Cramers = ta_Cramers_V(Obsidian)
